"use strict";define(["knockout","utils/dom","ojs/ojarraydataprovider","ojs/ojmutablearraydataprovider","ojs/ojlistview","ojs/ojbutton","ojs/ojtable"],function(t,e,i,a){return function(){return this.mainSectionClass=t.observable(),new class{initializeobservables(){this.remarksValue=t.observable(),this.warrantyValue=t.observable(),this.isWarrantyDisabled=t.observable(!0),this.inputWarrantyDataProvider=t.observable(new i([],{keyAttributes:"value"})),this.inputBrandDataProvider=t.observable(new i([],{keyAttributes:"value"})),this.inputTypeDataProvider=t.observable(new i([],{keyAttributes:"value"})),this.inputModelDataProvider=t.observable(new i([],{keyAttributes:"value"})),this.warrantyDataProvider=t.observable(new i([],{keyAttributes:"type"})),this.inputSucDateValue=t.observable(),this.isSucDateDisabled=t.observable(!1),this.inputDeliveryDateValue=t.observable(),this.isDeliverDateDisabled=t.observable(!1),this.modelValue=t.observable(),this.isModelDisabled=t.observable(!1),this.typeValue=t.observable(),this.isTypeDisabled=t.observable(!1),this.brandValue=t.observable(),this.isBrandDisabled=t.observable(!1),this.serialNumberValue=t.observable(),this.isSerialNumberDisabled=t.observable(!0),this.assetTagNumberValue=t.observable(),this.isAssetNumberDisabled=t.observable(!0)}createId(t,e){var i=[];return i.assetDetailsId="assetMappingBtn_"+t+"_"+e,i.serviceCheckListId="nextButton_"+t+"_"+e,i.prevHistoryId="prevHistoryDiv_"+t+"_"+e,i}listallAssets(e){var a=1;this.allAssetData=[],this.allAssetsDataProvider=t.observable(new i([],{keyAttributes:"serialNo"}));const n=e.inventoryList;console;for(const[t,i]of Object.entries(n)){var s=null!=e.activity.masterActivityId?e.activity.masterActivityId:"";if("customer"==i.invpool&&i.inv_aid==e.activity.aid||"customer"==i.invpool&&i.inv_aid==s){var r=i.invid,l=i.osc_asset_id,o=(null!=i.inv_capacity&&i.inv_capacity.length>0&&i.inv_capacity,null!=i.model_name&&i.model_name.length>0?i.model_name:""),v=(null!=e.activity.activity_organization&&e.activity.activity_organization.length>0&&e.activity.activity_organization,null!=i.inv_floor&&i.inv_floor.length>0?i.inv_floor:"NA"),y=null!=i.inv_room&&i.inv_room.length>0?i.inv_room:"NA",c=null!=i.inv_block&&i.inv_block.length>0?i.inv_block:"NA",u=null!=i.inv_type&&i.inv_type.length>0?i.inv_type:"",h=(null!=i.inv_visitNumber&&i.inv_visitNumber.length>0&&i.inv_visitNumber,null!=i.inv_number&&i.inv_number.length>0?i.inv_number:"NA"),d=null!=i.invsn&&i.invsn.length>0?i.invsn:"",b=null!=i.issue_type&&i.issue_type.length>0?i.issue_type:"NA",_=null!=i.inv_service_type&&i.inv_service_type.length>0?i.inv_service_type:"NA",p=null!=i.asset_remarks&&i.asset_remarks.length>0?i.asset_remarks:"NA",g=null!=i.warranty&&i.warranty.length>0?i.warranty:"NA";g="yes"==g?"Active":"Expired",1!=i.asset_verified?1!=i.service_checklist_completed&&(this.assetClass="demo-centering-box-red"):1!=i.service_checklist_completed?this.assetClass="demo-centering-box-yellow":this.assetClass="demo-centering-box-green";var m=this.createId(r,l);0==this.allAssetData.length?this.allAssetData=[{model:o,serialNo:d,wStatus:g,block:c,floor:v,room:y,machineNo:h,assetType:u,issueType:b,serviceType:_,remarks:p,count:a,assetMappingButtonId:m.assetDetailsId,serviceCheckListButtonId:m.serviceCheckListButtonId,serviceCheckListHistoryId:m.prevHistoryId}]:this.allAssetData.push({model:o,serialNo:d,wStatus:g,block:c,floor:v,room:y,machineNo:h,assetType:u,issueType:b,serviceType:_,remarks:p,count:a,assetMappingButtonId:m.assetDetailsId,serviceCheckListButtonId:m.serviceCheckListButtonId,serviceCheckListHistoryId:m.prevHistoryId}),a++}}"Preventive Maintenance"!=e.activity.aworktype&&this.allAssetsDataProvider(new i(this.allAssetData,{keyAttributes:"serialNo"}))}assetMapping(e,a,n){var e=e,s=new Date,r=s.getDate(),l=s.getMonth()+1;s.getFullYear(),l<10&&(l="0"+l),r<10&&(r="0"+r),null!=n.activity.activity_organization&&n.activity.activity_organization.length>0&&n.activity.activity_organization,null!=n.activity.project&&n.activity.project.length>0&&n.activity.project,null!=n.activity.caddress&&n.activity.caddress.length>0&&n.activity.caddress,null!=n.activity.reference_number&&n.activity.reference_number.length>0&&n.activity.reference_number,null!=n.activity.caddress&&n.activity.caddress.length>0&&n.activity.caddress;var o=null!=n.inventoryList[e].model_name&&n.inventoryList[e].model_name.length>0?n.inventoryList[e].model_name:"",v=null!=n.inventoryList[e].inv_type&&n.inventoryList[e].inv_type.length>0?n.inventoryList[e].inv_type:"",y=(null!=n.inventoryList[e].inv_block&&n.inventoryList[e].inv_block.length>0&&n.inventoryList[e].inv_block,null!=n.inventoryList[e].inv_floor&&n.inventoryList[e].inv_floor.length>0&&n.inventoryList[e].inv_floor,null!=n.inventoryList[e].inv_number&&n.inventoryList[e].inv_number.length>0&&n.inventoryList[e].inv_number,null!=n.inventoryList[e].invsn&&n.inventoryList[e].invsn.length>0?n.inventoryList[e].invsn:""),c=null!=n.inventoryList[e].brand&&n.inventoryList[e].brand.length>0?n.inventoryList[e].brand:"",u=(null!=n.inventoryList[e].capacity&&n.inventoryList[e].capacity.length>0&&n.inventoryList[e].capacity,null!=n.inventoryList[e].delivery_date&&n.inventoryList[e].delivery_date.length>0?n.inventoryList[e].delivery_date:""),h=null!=n.inventoryList[e].suc_date&&n.inventoryList[e].suc_date.length>0?n.inventoryList[e].suc_date:"",d=(null!=n.inventoryList[e].type&&n.inventoryList[e].type.length>0&&n.inventoryList[e].type,null!=n.inventoryList[e].warranty&&n.inventoryList[e].warranty.length>0?n.inventoryList[e].warranty:""),b=(null!=n.inventoryList[e].issue_type&&n.inventoryList[e].issue_type.length>0&&n.inventoryList[e].issue_type,null!=n.inventoryList[e].inv_service_type&&n.inventoryList[e].inv_service_type.length>0&&n.inventoryList[e].inv_service_type,null!=n.inventoryList[e].asset_remarks&&n.inventoryList[e].asset_remarks.length>0&&n.inventoryList[e].asset_remarks,null!=n.inventoryList[e].warranty_start_date&&n.inventoryList[e].warranty_start_date.length>0&&n.inventoryList[e].warranty_start_date,null!=n.inventoryList[e].warranty_end_date&&n.inventoryList[e].warranty_end_date.length>0&&n.inventoryList[e].warranty_end_date,null!=n.inventoryList[e].inv_warranty_info&&n.inventoryList[e].inv_warranty_info.length>0?n.inventoryList[e].inv_warranty_info:""),_=null!=n.inventoryList[e].inv_number&&n.inventoryList[e].inv_number.length>0?n.inventoryList[e].inv_number:"";this.serialNumberValue(y),this.assetTagNumberValue(_),this.brandArray=[{value:c||"Select Brand",label:c||"Select Brand"}],this.typeArray=[{value:v||"Select Type",label:v||"Select Type"}],this.modelArray=[{value:o||"Select Model",label:o||"Select Model"}],this.warrantyArray=[{value:d||"Select Warranty",label:d||"Select Warranty"},{value:"Not in wARRANTY",label:"No warranty"}],this.inputBrandDataProvider=t.observable(new i(this.brandArray,{keyAttributes:"value"})),this.inputTypeDataProvider(new i(this.typeArray,{keyAttributes:"value"})),this.inputModelDataProvider(new i(this.modelArray,{keyAttributes:"value"})),this.inputWarrantyDataProvider(new i(this.warrantyArray,{keyAttributes:"value"})),""!=u&&(this.inputDeliveryDateValue(u),this.isDeliverDateDisabled(!0)),""!=h&&(this.inputSucDateValue(h),this.isSucDateDisabled(!0)),this.generateWarrantyTable(e,b,n),1==n.inventoryList[e].asset_shutdown?this.assetShutdownValue=t.observableArray([1]):this.assetShutdownValue=t.observableArray([])}generateWarrantyTable(t,e,a){if(this.warrantyData=[],""!=e){var n=JSON.parse(e);if("Carrier"==a.inventoryList[t].brand||"Toshiba"==a.inventoryList[t].brand)if(n.warranty.length>0){for(const[t,e]of Object.entries(n.warranty)){var s=new Date(e.w_start),s=new Date(e.w_start),r=s.getDate(),l=s.getMonth()+1,o=s.getUTCFullYear().toString().substr(-2);l<10&&(l="0"+l),r<10&&(r="0"+r);var v=l+"/"+r+"/"+o;v.includes("NaN")&&(v="Not Available");var s=new Date(e.w_end),r=s.getDate(),l=s.getMonth()+1,o=s.getUTCFullYear().toString().substr(-2);l<10&&(l="0"+l),r<10&&(r="0"+r);var y=l+"/"+r+"/"+o;y.includes("NaN")&&(y="Not Available");var c=v+" - "+y,s=new Date(e.c_end),r=s.getDate(),l=s.getMonth()+1,o=s.getUTCFullYear().toString().substr(-2);l<10&&(l="0"+l),r<10&&(r="0"+r);var u=l+"/"+r+"/"+o;u.includes("NaN")&&(u="Not Available"),0==this.warrantyData.length?this.warrantyData=[{type:e.type,startEnd:c,compEnd:u}]:this.warrantyData.push({type:e.type,startEnd:c,compEnd:u})}this.warrantyDataProvider(new i(this.warrantyData,{keyAttributes:"type"}))}else console.log("Add section for warranty not available")}}handleActivated(e){this._controller=e.valueAccessor().params.app,this.ofscData=this._controller.openData(),console.log(this.ofscData),this.count=t.observable(),this.listallAssets(this.ofscData),this.assetData=[{account:null!=this.ofscData.activity.activity_organization&&this.ofscData.activity.activity_organization.length>0?this.ofscData.activity.activity_organization:"",site:null!=this.ofscData.activity.caddress&&this.ofscData.activity.caddress.length>0?this.ofscData.activity.caddress:"",refno:null!=this.ofscData.activity.reference_number&&this.ofscData.activity.reference_number.length>0?this.ofscData.activity.reference_number:""}],this.assetDataProvider=t.observable(new i(this.assetData,{keyAttributes:"account"}))}handleAttached(t){console.log("Page is Loaded "),this._controller=t.valueAccessor().params.app,this.initializeobservables(),this.ofscData=this._controller.openData(),console.log(this.ofscData),this._doc=document.getElementById("mainSectionPanel"),this._assetDoc=document.getElementById("assetVerifySectionPanel"),this.assetButtonAction=function(t){this._doc.classList.add("ishidden"),this._assetDoc.classList.remove("ishidden");var e=t.target.id,i=e.split("_"),a=i[1],n=i[2];this.assetMapping(a,n,this.ofscData)}.bind(this)}}}});